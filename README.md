# ğŸ¤– LLM æ™ºèƒ½å®¢æœç³»ç»Ÿ

åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ä¼ä¸šçº§æ™ºèƒ½å®¢æœç³»ç»Ÿï¼Œé›†æˆ RAG æ£€ç´¢å¢å¼ºç”Ÿæˆã€å¤šè½®å¯¹è¯è®°å¿†ã€æ„å›¾è¯†åˆ«ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯å±‚                              â”‚
â”‚          Vue3 å‰ç«¯  â”€â”€  WebSocket  â”€â”€  REST API             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API ç½‘å…³å±‚ (FastAPI)                    â”‚
â”‚        è®¤è¯ä¸­é—´ä»¶  â”‚  é™æµä¸­é—´ä»¶  â”‚  æ—¥å¿—ä¸­é—´ä»¶              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚              â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¯¹è¯æœåŠ¡   â”‚ â”‚  çŸ¥è¯†åº“æœåŠ¡ â”‚ â”‚  ç”¨æˆ·æœåŠ¡   â”‚ â”‚  è¯„ä¼°æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â”‚              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ ¸å¿ƒå¼•æ“å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ LLMå®¢æˆ·ç«¯ â”‚  â”‚ RAGæ£€ç´¢  â”‚  â”‚ æ„å›¾è¯†åˆ« â”‚  â”‚ è®°å¿†ç®¡ç† â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å­˜å‚¨å±‚                                 â”‚
â”‚   PostgreSQL    â”‚    Redis    â”‚    ChromaDB    â”‚  æ–‡ä»¶å­˜å‚¨  â”‚
â”‚  (ç”¨æˆ·/å¯¹è¯)    â”‚   (ç¼“å­˜)    â”‚  (å‘é‡æ•°æ®åº“)  â”‚  (æ–‡æ¡£)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| åç«¯æ¡†æ¶ | FastAPI | 0.109+ |
| LLMç¼–æ’ | LangChain | 0.2+ |
| LLMæ¨¡å‹ | OpenAI GPT-4 / Ollama | - |
| å‘é‡æ•°æ®åº“ | ChromaDB | 0.5+ |
| å…³ç³»æ•°æ®åº“ | PostgreSQL | 15+ |
| ç¼“å­˜ | Redis | 7+ |
| å‰ç«¯æ¡†æ¶ | Vue 3 + Vite | - |
| è®¤è¯ | JWT (python-jose) | - |
| å®¹å™¨åŒ– | Docker + Docker Compose | - |
| æµ‹è¯• | Pytest | 7+ |

## ğŸ“ é¡¹ç›®ç»“æ„

```
llm_example/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ main.py                 # FastAPI å…¥å£
â”‚   â”œâ”€â”€ config.py               # å…¨å±€é…ç½®
â”‚   â”œâ”€â”€ api/                    # API è·¯ç”±å±‚
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ chat.py         # å¯¹è¯æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.py         # è®¤è¯æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ knowledge.py    # çŸ¥è¯†åº“æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ admin.py        # ç®¡ç†åå°æ¥å£
â”‚   â”‚   â””â”€â”€ middleware/
â”‚   â”‚       â”œâ”€â”€ auth.py         # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚       â””â”€â”€ rate_limit.py   # é™æµä¸­é—´ä»¶
â”‚   â”œâ”€â”€ core/                   # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ llm/
â”‚   â”‚   â”‚   â”œâ”€â”€ client.py       # LLM å®¢æˆ·ç«¯ (OpenAI/Ollama)
â”‚   â”‚   â”‚   â””â”€â”€ prompt_manager.py # Prompt æ¨¡æ¿ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ rag/
â”‚   â”‚   â”‚   â”œâ”€â”€ embedder.py     # æ–‡æœ¬å‘é‡åŒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ retriever.py    # ç›¸ä¼¼åº¦æ£€ç´¢
â”‚   â”‚   â”‚   â””â”€â”€ vector_store.py # ChromaDB ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ memory/
â”‚   â”‚   â”‚   â””â”€â”€ conversation_memory.py # å¯¹è¯ä¸Šä¸‹æ–‡è®°å¿†
â”‚   â”‚   â””â”€â”€ intent/
â”‚   â”‚       â””â”€â”€ classifier.py   # æ„å›¾è¯†åˆ«åˆ†ç±»å™¨
â”‚   â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹ (SQLAlchemy)
â”‚   â”‚   â”œâ”€â”€ user.py
â”‚   â”‚   â”œâ”€â”€ conversation.py
â”‚   â”‚   â””â”€â”€ knowledge.py
â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ chat_service.py     # å¯¹è¯ç¼–æ’æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ knowledge_service.py # çŸ¥è¯†åº“ç®¡ç†
â”‚   â”‚   â””â”€â”€ auth_service.py     # ç”¨æˆ·è®¤è¯
â”‚   â”œâ”€â”€ db/                     # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â””â”€â”€ database.py
â”‚   â””â”€â”€ utils/                  # å·¥å…·ç±»
â”‚       â”œâ”€â”€ logger.py
â”‚       â””â”€â”€ cache.py
â”œâ”€â”€ frontend/                   # Vue3 å‰ç«¯
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ vite.config.js
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ App.vue
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ ChatWindow.vue  # èŠå¤©ä¸»çª—å£
â”‚       â”‚   â”œâ”€â”€ MessageBubble.vue # æ¶ˆæ¯æ°”æ³¡
â”‚       â”‚   â””â”€â”€ KnowledgeAdmin.vue # çŸ¥è¯†åº“ç®¡ç†
â”‚       â”œâ”€â”€ store/
â”‚       â”‚   â””â”€â”€ chat.js         # Pinia çŠ¶æ€ç®¡ç†
â”‚       â””â”€â”€ api/
â”‚           â””â”€â”€ index.js        # API è¯·æ±‚å°è£…
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/                   # å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ integration/            # é›†æˆæµ‹è¯•
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ architecture.md
â”‚   â””â”€â”€ api.md
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ init_db.py              # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â””â”€â”€ load_knowledge.py       # çŸ¥è¯†åº“å¯¼å…¥
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ knowledge_base/         # çŸ¥è¯†åº“æ–‡æ¡£
â”‚   â””â”€â”€ chroma_db/              # å‘é‡æ•°æ®åº“æŒä¹…åŒ–
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env.example
â””â”€â”€ requirements.txt
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ OpenAI API Key ç­‰é…ç½®
```

### 2. å¯åŠ¨åŸºç¡€æœåŠ¡
```bash
docker-compose up -d postgres redis
```

### 3. åˆå§‹åŒ–æ•°æ®åº“
```bash
pip install -r requirements.txt
python scripts/init_db.py
```

### 4. å¯¼å…¥çŸ¥è¯†åº“
```bash
python scripts/load_knowledge.py --dir data/knowledge_base
```

### 5. å¯åŠ¨åç«¯
```bash
cd backend
uvicorn main:app --reload --port 8000
```

### 6. å¯åŠ¨å‰ç«¯
```bash
cd frontend
npm install && npm run dev
```

### 7. ä¸€é”® Docker å¯åŠ¨
```bash
docker-compose up -d
```

## ğŸ“¡ API æ¥å£

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| POST | `/api/auth/login` | ç”¨æˆ·ç™»å½• |
| POST | `/api/auth/register` | ç”¨æˆ·æ³¨å†Œ |
| POST | `/api/chat/message` | å‘é€æ¶ˆæ¯ |
| GET  | `/api/chat/history/{session_id}` | è·å–å¯¹è¯å†å² |
| WS   | `/ws/chat/{session_id}` | WebSocket æµå¼å¯¹è¯ |
| POST | `/api/knowledge/upload` | ä¸Šä¼ çŸ¥è¯†æ–‡æ¡£ |
| GET  | `/api/knowledge/list` | çŸ¥è¯†åº“åˆ—è¡¨ |
| GET  | `/api/admin/stats` | ç³»ç»Ÿç»Ÿè®¡ |

## ğŸ”‘ æ ¸å¿ƒç‰¹æ€§

- âœ… **å¤šè½®å¯¹è¯** - åŸºäºæ»‘åŠ¨çª—å£çš„ä¸Šä¸‹æ–‡ç®¡ç†
- âœ… **RAG æ£€ç´¢** - çŸ¥è¯†åº“è¯­ä¹‰æ£€ç´¢å¢å¼ºå›ç­”
- âœ… **æ„å›¾è¯†åˆ«** - è‡ªåŠ¨åˆ†ç±»ç”¨æˆ·æ„å›¾ï¼ˆå’¨è¯¢/æŠ•è¯‰/å”®åç­‰ï¼‰
- âœ… **æµå¼è¾“å‡º** - WebSocket å®æ—¶ Token æµå¼ä¼ è¾“
- âœ… **å¤šæ¨¡å‹æ”¯æŒ** - OpenAI / Ollama æœ¬åœ°æ¨¡å‹åˆ‡æ¢
- âœ… **JWT è®¤è¯** - å®‰å…¨çš„ç”¨æˆ·èº«ä»½éªŒè¯
- âœ… **ç¼“å­˜åŠ é€Ÿ** - Redis å¯¹è¯ç¼“å­˜ + å‘é‡æ£€ç´¢ç¼“å­˜
- âœ… **è´¨é‡ç›‘æ§** - å¯¹è¯æ»¡æ„åº¦è¯„ä¼°ä¸æŒ‡æ ‡è¿½è¸ª

## ğŸ“„ License

MIT
